Untitled
================

``` r
setwd("C:/Users/ktm/Desktop/project/Bike_sharing")
bike <- read.csv("train.csv")

str(bike)
```

    ## 'data.frame':    10886 obs. of  12 variables:
    ##  $ datetime  : Factor w/ 10886 levels "2011-01-01 00:00:00",..: 1 2 3 4 5 6 7 8 9 10 ...
    ##  $ season    : int  1 1 1 1 1 1 1 1 1 1 ...
    ##  $ holiday   : int  0 0 0 0 0 0 0 0 0 0 ...
    ##  $ workingday: int  0 0 0 0 0 0 0 0 0 0 ...
    ##  $ weather   : int  1 1 1 1 1 2 1 1 1 1 ...
    ##  $ temp      : num  9.84 9.02 9.02 9.84 9.84 ...
    ##  $ atemp     : num  14.4 13.6 13.6 14.4 14.4 ...
    ##  $ humidity  : int  81 80 80 75 75 75 80 86 75 76 ...
    ##  $ windspeed : num  0 0 0 0 0 ...
    ##  $ casual    : int  3 8 5 3 0 0 2 1 1 8 ...
    ##  $ registered: int  13 32 27 10 1 1 0 2 7 6 ...
    ##  $ count     : int  16 40 32 13 1 1 2 3 8 14 ...

``` r
hol <- as.factor(bike$holiday)
coplot(bike$count~bike$registered | hol)
```

![](ggplot_files/figure-markdown_github/unnamed-chunk-2-1.png)

``` r
# 
cols <- terrain.colors(462)
seas <- as.factor(bike$season)
coplot(bike$count~bike$temp | seas,
       col = cols[seas])
```

![](ggplot_files/figure-markdown_github/unnamed-chunk-2-2.png)

GG
--

``` r
g <-rnorm(100, mean = 1, sd = 0.3)
k <-rnorm(100, sd = 0.3)
matrix(g, ncol = 2)
```

    ##            [,1]      [,2]
    ##  [1,] 0.5537292 0.7434447
    ##  [2,] 0.4603860 1.0184791
    ##  [3,] 1.2085960 1.0881772
    ##  [4,] 1.4875905 0.9982795
    ##  [5,] 0.8772591 1.1621517
    ##  [6,] 0.9350502 1.3143484
    ##  [7,] 0.8922323 0.8470872
    ##  [8,] 1.1422067 1.1557549
    ##  [9,] 1.1942195 1.0634589
    ## [10,] 0.8995159 0.7403064
    ## [11,] 0.8818071 0.7343876
    ## [12,] 0.5409466 1.6725583
    ## [13,] 0.8307855 0.6188834
    ## [14,] 1.4537848 0.9078503
    ## [15,] 0.5259954 1.3030574
    ## [16,] 1.1157619 0.6016109
    ## [17,] 1.0441922 1.0130458
    ## [18,] 0.8300585 1.0928581
    ## [19,] 1.1040980 0.8412262
    ## [20,] 0.6630758 0.6328519
    ## [21,] 0.8862503 0.4444547
    ## [22,] 0.5829179 0.8532123
    ## [23,] 0.7803380 1.1325234
    ## [24,] 1.0439057 0.9255497
    ## [25,] 0.4752970 1.2432910
    ## [26,] 0.8219194 1.1450697
    ## [27,] 0.8014210 1.1106268
    ## [28,] 0.8716769 1.0002880
    ## [29,] 0.8739107 0.7814884
    ## [30,] 0.7667414 0.3728584
    ## [31,] 0.6389186 1.3996509
    ## [32,] 1.1076852 0.8429979
    ## [33,] 0.8850217 1.6628805
    ## [34,] 0.6652728 0.8771049
    ## [35,] 0.9417967 0.7496057
    ## [36,] 1.3576073 0.6064331
    ## [37,] 0.7660484 1.1146867
    ## [38,] 1.1986942 1.6873185
    ## [39,] 0.8832307 1.0582130
    ## [40,] 0.9550069 0.8087668
    ## [41,] 0.8483385 1.3960040
    ## [42,] 0.9607104 1.0931423
    ## [43,] 1.2474836 0.6760639
    ## [44,] 0.8694941 0.7420323
    ## [45,] 0.9965306 0.7556008
    ## [46,] 0.7567560 1.5709368
    ## [47,] 1.0815365 0.9670091
    ## [48,] 1.2622476 1.1363133
    ## [49,] 0.8885602 0.7700787
    ## [50,] 0.8048871 1.1941007

``` r
x <-rbind(matrix(g, ncol = 2), matrix(k, ncol=2))
```

``` r
# k means 는 거리를 통해서 나누어 준 이후 중심을 찾음
cl <- kmeans(x, centers = 2, iter.max = 20)
plot(x, col=cl$cluster)
```

![](ggplot_files/figure-markdown_github/unnamed-chunk-5-1.png)

``` r
# 각 값은 200개로 지정
# mean = 5 
# sd = 0.5
# mean = 3
# sd = 0.3
# 그룹 3개로 만들기

g1 <- rnorm(200, mean = 5, sd = 0.5)
g2 <- rnorm(200, mean = 3, sd = 0.3)

x1 <- rbind(matrix(g1, ncol=2), matrix(g2, ncol=2))
x1
```

    ##            [,1]     [,2]
    ##   [1,] 4.429305 5.308984
    ##   [2,] 5.146263 5.194143
    ##   [3,] 5.219640 4.500353
    ##   [4,] 4.731918 5.153145
    ##   [5,] 4.177537 5.128088
    ##   [6,] 5.370499 5.877292
    ##   [7,] 5.969649 5.389168
    ##   [8,] 5.163805 4.912788
    ##   [9,] 5.154183 5.155669
    ##  [10,] 4.635539 4.704750
    ##  [11,] 5.020574 4.466637
    ##  [12,] 5.387614 4.605657
    ##  [13,] 5.280029 5.297278
    ##  [14,] 4.149338 5.245663
    ##  [15,] 5.225805 4.528794
    ##  [16,] 5.328167 4.549361
    ##  [17,] 5.265402 3.354461
    ##  [18,] 6.134268 4.586828
    ##  [19,] 5.100820 5.317395
    ##  [20,] 5.407088 5.688227
    ##  [21,] 5.587013 4.675611
    ##  [22,] 4.756934 4.761344
    ##  [23,] 5.173059 4.825382
    ##  [24,] 4.281742 4.694322
    ##  [25,] 4.479773 3.883719
    ##  [26,] 5.780120 5.616702
    ##  [27,] 4.539361 5.409403
    ##  [28,] 4.589352 4.795417
    ##  [29,] 5.352872 5.734936
    ##  [30,] 5.056819 4.849608
    ##  [31,] 5.510967 5.965341
    ##  [32,] 4.746342 4.652805
    ##  [33,] 5.461361 4.576905
    ##  [34,] 5.767898 4.171181
    ##  [35,] 5.375422 4.671020
    ##  [36,] 5.142986 4.622668
    ##  [37,] 5.289863 5.175324
    ##  [38,] 4.199775 5.899730
    ##  [39,] 4.642015 4.593490
    ##  [40,] 4.304376 4.390487
    ##  [41,] 4.753770 5.378342
    ##  [42,] 5.206120 4.754396
    ##  [43,] 4.467741 4.370994
    ##  [44,] 6.052484 4.718434
    ##  [45,] 5.266399 5.167878
    ##  [46,] 5.255328 5.166495
    ##  [47,] 4.680055 5.236216
    ##  [48,] 5.307768 4.939827
    ##  [49,] 5.518360 4.946451
    ##  [50,] 6.086851 5.391948
    ##  [51,] 4.250453 5.266158
    ##  [52,] 4.766792 5.636311
    ##  [53,] 4.994814 5.464569
    ##  [54,] 4.826222 4.526383
    ##  [55,] 4.773715 5.459311
    ##  [56,] 5.494961 5.734993
    ##  [57,] 4.923485 5.529539
    ##  [58,] 4.647583 4.706737
    ##  [59,] 5.579933 4.852982
    ##  [60,] 4.761577 5.711591
    ##  [61,] 4.640815 4.249323
    ##  [62,] 4.457747 5.144827
    ##  [63,] 4.342854 4.404352
    ##  [64,] 5.366189 5.240424
    ##  [65,] 5.591602 5.411922
    ##  [66,] 4.814079 4.907934
    ##  [67,] 3.555056 5.263878
    ##  [68,] 4.963513 5.468070
    ##  [69,] 5.275262 4.097866
    ##  [70,] 4.946951 4.266797
    ##  [71,] 5.545216 4.447186
    ##  [72,] 5.161966 6.206144
    ##  [73,] 5.052389 5.637782
    ##  [74,] 5.239637 4.182475
    ##  [75,] 5.132306 4.449420
    ##  [76,] 4.315418 5.256547
    ##  [77,] 5.878134 4.391762
    ##  [78,] 5.641971 5.413649
    ##  [79,] 5.010031 4.849427
    ##  [80,] 5.556018 5.222181
    ##  [81,] 4.532395 4.888104
    ##  [82,] 5.051752 5.129215
    ##  [83,] 4.808955 3.856831
    ##  [84,] 4.818458 4.242706
    ##  [85,] 4.057111 5.098023
    ##  [86,] 4.610438 4.482755
    ##  [87,] 5.501330 4.498381
    ##  [88,] 5.990481 3.918790
    ##  [89,] 5.596697 5.059870
    ##  [90,] 5.354004 4.536680
    ##  [91,] 3.674982 4.838341
    ##  [92,] 5.129006 5.287781
    ##  [93,] 5.047777 4.667279
    ##  [94,] 4.308261 4.666702
    ##  [95,] 4.968541 4.707240
    ##  [96,] 4.448763 4.635430
    ##  [97,] 4.817373 5.383977
    ##  [98,] 6.196482 5.693321
    ##  [99,] 5.229076 5.255932
    ## [100,] 5.025307 5.277459
    ## [101,] 2.676269 3.225450
    ## [102,] 2.980110 3.004657
    ## [103,] 3.209860 2.546935
    ## [104,] 3.135795 3.857500
    ## [105,] 2.508279 3.661634
    ## [106,] 2.454257 2.850503
    ## [107,] 3.722603 3.141814
    ## [108,] 3.283231 2.709394
    ## [109,] 2.426758 2.844540
    ## [110,] 3.131442 3.016166
    ## [111,] 2.970549 2.991385
    ## [112,] 3.074640 3.045457
    ## [113,] 2.883897 2.968578
    ## [114,] 2.701852 3.104631
    ## [115,] 3.288607 3.251487
    ## [116,] 2.978085 3.058842
    ## [117,] 3.378906 2.929579
    ## [118,] 3.389150 3.202576
    ## [119,] 3.178753 3.408899
    ## [120,] 2.789339 2.749299
    ## [121,] 2.755903 3.423909
    ## [122,] 3.280697 3.399871
    ## [123,] 3.146444 2.915904
    ## [124,] 3.045074 2.335644
    ## [125,] 3.039838 2.818187
    ## [126,] 3.030075 3.018519
    ## [127,] 3.372165 2.502080
    ## [128,] 2.739466 2.850680
    ## [129,] 2.596148 2.709559
    ## [130,] 3.014266 2.530129
    ## [131,] 3.277199 2.852762
    ## [132,] 3.216748 3.258500
    ## [133,] 3.104142 2.841756
    ## [134,] 3.295642 3.088454
    ## [135,] 3.417147 2.727582
    ## [136,] 3.091554 3.125505
    ## [137,] 2.937111 3.149431
    ## [138,] 2.583418 2.851613
    ## [139,] 2.480816 3.175700
    ## [140,] 2.688934 3.095998
    ## [141,] 3.321725 2.972774
    ## [142,] 3.128023 3.485553
    ## [143,] 3.356049 3.206083
    ## [144,] 3.007508 3.277542
    ## [145,] 3.241763 2.687738
    ## [146,] 3.394183 2.897652
    ## [147,] 2.723040 2.944392
    ## [148,] 3.110909 3.410819
    ## [149,] 3.239699 3.243933
    ## [150,] 2.557459 2.291907
    ## [151,] 3.005451 3.209826
    ## [152,] 2.614909 2.867108
    ## [153,] 2.707631 2.814007
    ## [154,] 2.749704 3.059121
    ## [155,] 2.960506 3.695374
    ## [156,] 3.812484 3.273636
    ## [157,] 2.827397 3.103446
    ## [158,] 2.780255 2.708095
    ## [159,] 3.129948 3.351233
    ## [160,] 2.881380 3.344607
    ## [161,] 2.831883 3.022405
    ## [162,] 3.323004 3.226551
    ## [163,] 2.777208 3.505105
    ## [164,] 2.931823 3.407779
    ## [165,] 2.938611 3.163704
    ## [166,] 2.707217 2.748028
    ## [167,] 3.035610 2.795665
    ## [168,] 3.421858 2.892438
    ## [169,] 3.147550 2.827156
    ## [170,] 2.634649 3.054839
    ## [171,] 2.825823 2.868994
    ## [172,] 3.306982 3.067137
    ## [173,] 2.984053 2.801721
    ## [174,] 2.384832 3.779835
    ## [175,] 2.148645 3.046719
    ## [176,] 2.767593 2.721791
    ## [177,] 3.063580 2.804822
    ## [178,] 3.495988 2.844643
    ## [179,] 2.277808 3.023491
    ## [180,] 3.058040 3.034830
    ## [181,] 3.116777 3.112835
    ## [182,] 3.150856 3.082574
    ## [183,] 2.582568 2.781110
    ## [184,] 2.987375 3.146746
    ## [185,] 3.684091 3.102556
    ## [186,] 3.241968 2.701432
    ## [187,] 3.315432 3.300613
    ## [188,] 3.120952 3.301433
    ## [189,] 2.712005 2.700119
    ## [190,] 2.581577 2.829947
    ## [191,] 2.974106 2.908439
    ## [192,] 2.518030 2.716763
    ## [193,] 2.722364 3.306098
    ## [194,] 2.501497 3.393414
    ## [195,] 3.057021 3.604282
    ## [196,] 2.769139 2.957085
    ## [197,] 2.831028 3.172427
    ## [198,] 3.144281 2.669078
    ## [199,] 3.193512 2.797609
    ## [200,] 3.212318 3.119049

``` r
cl1 <- kmeans(x1, centers = 3, iter.max = 20)
cl1
```

    ## K-means clustering with 3 clusters of sizes 45, 55, 100
    ## 
    ## Cluster means:
    ##       [,1]     [,2]
    ## 1 4.631458 4.696822
    ## 2 5.367066 5.148535
    ## 3 2.983048 3.034272
    ## 
    ## Clustering vector:
    ##   [1] 1 2 1 1 1 2 2 2 2 1 1 2 2 1 1 2 1 2 2 2 2 1 2 1 1 2 1 1 2 2 2 1 2 2 2
    ##  [36] 1 2 1 1 1 2 2 1 2 2 2 1 2 2 2 1 2 2 1 2 2 2 1 2 2 1 1 1 2 2 1 1 2 1 1
    ##  [71] 2 2 2 1 1 1 2 2 1 2 1 2 1 1 1 1 2 2 2 2 1 2 1 1 1 1 2 2 2 2 3 3 3 3 3
    ## [106] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
    ## [141] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
    ## [176] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
    ## 
    ## Within cluster sum of squares by cluster:
    ## [1] 16.84747 19.51066 18.62252
    ##  (between_SS / total_SS =  88.2 %)
    ## 
    ## Available components:
    ## 
    ## [1] "cluster"      "centers"      "totss"        "withinss"    
    ## [5] "tot.withinss" "betweenss"    "size"         "iter"        
    ## [9] "ifault"

``` r
plot(x1, col = cl1$cluster)
```

![](ggplot_files/figure-markdown_github/unnamed-chunk-6-1.png)

##### GG1

``` r
library(ggplot2)
library(ggthemes)
```

``` r
colnames(diamonds)
```

    ##  [1] "carat"   "cut"     "color"   "clarity" "depth"   "table"   "price"  
    ##  [8] "x"       "y"       "z"

``` r
g1 <-ggplot(diamonds, aes(x=carat, y = price, colour = clarity))
g2 <-geom_point()
g3 <- theme_wsj()
g1+g2+g3
```

![](ggplot_files/figure-markdown_github/unnamed-chunk-8-1.png)

x = carat, y = price, colour = cut, facet\_grid = clarity
=========================================================

``` r
ga <- ggplot(diamonds, aes(x=carat, y = price, colour = cut))
gb <- geom_point()
gc <- theme_wsj()
gd <- facet_grid(.~clarity)
ga + gb + gc + gd
```

![](ggplot_files/figure-markdown_github/unnamed-chunk-9-1.png)
